<UserControl x:Class="BIA.ToolKit.UserControls.VersionAndOptionUserControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
             xmlns:local="clr-namespace:BIA.ToolKit.ViewModels"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             d:DesignWidth="800"
             MaxHeight="250"
             mc:Ignorable="d">

    <UserControl.DataContext>
        <local:VersionAndOptionViewModel />
    </UserControl.DataContext>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="0.4*" />
            <ColumnDefinition Width="0.6*" />
            <ColumnDefinition />
        </Grid.ColumnDefinitions>

        <!-- Framework Version ComboBox -->
        <ComboBox Grid.Column="0"
                  VerticalAlignment="Top"
                  materialDesign:HintAssist.Hint="Framework Version"
                  DisplayMemberPath="VersionLabel"
                  ItemsSource="{Binding WorkTemplates}"
                  SelectedItem="{Binding WorkTemplate}"
                  Style="{StaticResource MaterialDesignFilledComboBox}">
            <i:Interaction.Triggers>
                <i:EventTrigger EventName="SelectionChanged">
                    <i:InvokeCommandAction Command="{Binding FrameworkVersionSelectionChangedCommand}" />
                </i:EventTrigger>
            </i:Interaction.Triggers>
        </ComboBox>

        <!-- Feature Settings GroupBox -->
        <GroupBox x:Name="FeatureSettingsGroup"
                  Grid.Column="1"
                  Margin="10,0"
                  VerticalAlignment="Top"
                  Background="#323232"
                  Foreground="White"
                  Header="Feature Settings"
                  d:Visibility="Visible">
            <ScrollViewer Height="135"
                          HorizontalScrollBarVisibility="Hidden"
                          VerticalScrollBarVisibility="Auto">
                <Grid>
                    <ItemsControl Margin="0,0,10,0"
                                  ItemsSource="{Binding FeatureSettings}"
                                  Visibility="{Binding AreFeatureVisible, Converter={StaticResource BoolToVisConverter}}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal">
                                    <CheckBox Margin="0,5"
                                              Command="{Binding DataContext.OnFeatureSettingSelectionChangedCommand, RelativeSource={RelativeSource AncestorType=ItemsControl}}"
                                              Content="{Binding Name}"
                                              Foreground="White"
                                              IsChecked="{Binding IsSelected}"
                                              ToolTip="{Binding Description}" />
                                    <materialDesign:PackIcon Width="20"
                                                             Height="20"
                                                             Margin="5,0,0,0"
                                                             VerticalAlignment="Center"
                                                             Kind="AlertCircle"
                                                             Visibility="{Binding DisplayDisabledFeatures, Converter={StaticResource BoolToVisConverter}}">
                                        <materialDesign:PackIcon.ToolTip>
                                            <StackPanel Orientation="Horizontal">
                                                <Label Content="Automatically disabled :" Foreground="Black" />
                                                <Label Content="{Binding DisabledFeatures, Mode=OneWay}"
                                                       FontWeight="Bold"
                                                       Foreground="Black" />
                                            </StackPanel>
                                        </materialDesign:PackIcon.ToolTip>
                                    </materialDesign:PackIcon>
                                </StackPanel>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                    <Label Margin="3,3,0,2"
                           Content="No available feature"
                           FontSize="15"
                           FontWeight="Bold"
                           Visibility="{Binding IsVisibileNoFeature, Converter={StaticResource BoolToVisConverter}}" />
                </Grid>
            </ScrollViewer>
        </GroupBox>

        <!-- Company Files GroupBox -->
        <GroupBox x:Name="CompanyFileGroup"
                  Grid.Column="2"
                  VerticalAlignment="Top"
                  Background="#323232"
                  Foreground="White"
                  Header="Company files">
            <Grid Margin="0,0,10,0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <!-- Warning when Company Files is off -->
                <StackPanel Grid.Row="0"
                            Grid.RowSpan="2"
                            VerticalAlignment="Center"
                            Orientation="Horizontal"
                            Visibility="{Binding SettingsNotUseCompanyFiles, Converter={StaticResource BoolToVisConverter}}">
                    <Image x:Name="Warning"
                           Height="40"
                           HorizontalAlignment="Left"
                           RenderOptions.BitmapScalingMode="Fant"
                           Source="..\Images\Warning.png" />
                    <Label x:Name="WarningLabel"
                           VerticalAlignment="Center"
                           Content="Use Company Files is off"
                           FontSize="15"
                           FontWeight="Bold"
                           Foreground="White" />
                </StackPanel>

                <!-- Company Files Settings -->
                <Grid Visibility="{Binding SettingsUseCompanyFiles, Converter={StaticResource BoolToVisConverter}}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>

                    <Grid Grid.Column="0">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>

                        <CheckBox x:Name="UseCompanyFiles"
                                  Grid.Row="0"
                                  Margin="0,5"
                                  Content="Use Company Files"
                                  Foreground="White"
                                  IsChecked="{Binding UseCompanyFiles}" />

                        <ComboBox Grid.Row="1"
                                  Margin="0,5"
                                  materialDesign:HintAssist.Hint="Company File Version"
                                  DisplayMemberPath="VersionLabel"
                                  ItemsSource="{Binding WorkCompanyFiles}"
                                  SelectedItem="{Binding WorkCompanyFile}"
                                  Style="{StaticResource MaterialDesignFilledComboBox}"
                                  Visibility="{Binding UseCompanyFiles, Converter={StaticResource BoolToVisConverter}}">
                            <i:Interaction.Triggers>
                                <i:EventTrigger EventName="SelectionChanged">
                                    <i:InvokeCommandAction Command="{Binding CompanyFilesSelectionChangedCommand}" />
                                </i:EventTrigger>
                            </i:Interaction.Triggers>
                        </ComboBox>

                        <ComboBox Grid.Row="2"
                                  Margin="0,5"
                                  materialDesign:HintAssist.Hint="Profile"
                                  ItemsSource="{Binding Profiles}"
                                  SelectedItem="{Binding Profile}"
                                  Style="{StaticResource MaterialDesignFilledComboBox}"
                                  Visibility="{Binding UseCompanyFiles, Converter={StaticResource BoolToVisConverter}}" />
                    </Grid>

                    <Grid Grid.Column="1"
                          Margin="10,0"
                          Visibility="{Binding UseCompanyFiles, Converter={StaticResource BoolToVisConverter}}">
                        <ScrollViewer Height="135"
                                      HorizontalScrollBarVisibility="Hidden"
                                      VerticalScrollBarVisibility="Auto">
                            <ItemsControl ItemsSource="{Binding Options}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <CheckBox Margin="0,5"
                                                  HorizontalAlignment="Left"
                                                  VerticalAlignment="Top"
                                                  Content="{Binding Name}"
                                                  Foreground="White"
                                                  IsChecked="{Binding IsChecked}" />
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </ScrollViewer>
                    </Grid>
                </Grid>
            </Grid>
        </GroupBox>
    </Grid>
</UserControl>
